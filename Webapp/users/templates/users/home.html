{% extends "users/base.html" %}
{% block title %} Home Page {% endblock title%}
{% block content %}
    <div class="jumbotron">
        
               
        <p class="lead">
            <div class="form-row">
                <div class="col-md-10">
                    <h1 class="display-4">Welcome, {{user.first_name.title|default:user.username.title|default:'Guest'}}</h1>
                    {% if user.is_authenticated == 0 %}
                        Please sign in or sign up to use our portal 
                    {% endif %}
                    
                </div>
                <div class="col-md-2">
                    {% if user.is_authenticated %}
                <a class="btn btn-primary btn-lg" href="{% url 'logout' %}" role="button">Logout</a>
                    {% else %}
                <a class="btn btn-primary btn-lg" href="{% url 'login' %}" role="button">Sign in</a>
                    {% endif %}
                </div>
            </div>           
        </p>
        
        {% if user.is_authenticated == 1 %}
        <p class="placement">
            College Placement
            <div id="container" style="width: 75%;">
                <canvas id="line-chart" ></canvas>
            </div>
        </p>
        {% endif %}
        
        {% if user.is_staff %}
        <p class="lead">
            Number Of Approved students
            <div id="container" style="width: 75%;">
                <canvas id="pie-chart"></canvas>
            </div>
        </p>

        <p class="lead">
            Students Percentage
            <div id="container" style="width: 75%;">
                <canvas id="percentage-chart" ></canvas>
            </div>
        </p>
        {% endif %}
       
    
    <hr class="my-4">

    </div>
    
            <script>

            function getRandomColor() { //generates random colours and puts them in string
                var colors = [];
                for (var i = 0; i < 50; i++) {
                    var letters = '0123456789ABCDEF'.split('');
                    var color = '#';
                    for (var x = 0; x < 6; x++) {
                    color += letters[Math.floor(Math.random() * 16)];
                    }
                    colors.push(color);
                }
                return colors;
                }

            var pieconfig = {
                type: 'pie',
                data: {
                    datasets: [{
                                    data: {{ piedata|safe }},
                                    backgroundColor: ['#b4ea5d','#ff5733'],
                                    label: 'Students'
                                }],
                    labels: {{ pielabels|safe }}
                },
                options: {
                    responsive: true,
                }
                };

            var lineconfig = {
                type: 'line',
                data: {
                    datasets: [{    
                                    data: [30,37,48,65,69,76,74,82,83,85,90,88],
                                    fill:false,                                    
                                    label: ['BCA'],
                                    borderColor: 'rgb(207, 190, 35)',
                                    tension: 0.1
                                },
                                {    
                                    data: [35,22,44,62,71,72,72,82,81,88,83,81],
                                    fill:false, 
                                    label: ['BSC'],
                                    borderColor: 'rgb(50, 168, 82)',
                                    tension: 0.1
                                }  ,
                                {    
                                    data: [12,22,23,34,36,31,38,41,54,70,61,63],
                                    fill:false, 
                                    label: ['BCOM'],    
                                    borderColor: 'rgb(207, 35, 67)',
                                    tension: 0.1                                
                                }    
                            ],
                    labels: [2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023]
                },
                options: {
                    responsive: true,
                    scales: {
                            yAxes: [{
                                // display: true,
                                stacked: false,
                                ticks: {
                                    min: 0, // minimum value
                                    max: 100 // maximum value
                                }
                            }]
                        }
                }
                
                
                
                };


            var barconfig = {
                type: 'bar',
                data: {
                    datasets: [{
                                    data: {{ bardata|safe }},
                                    backgroundColor: getRandomColor(),
                                    
                                }],
                    labels: {{ barlabels|safe }}
                },
                options: {
                    legend: {
                        display: false
                    },
                    responsive: true
                }
                };
    
       
        window.onload = function() {

        var ctx2 = document.getElementById('line-chart').getContext('2d');
        window.myLine = new Chart(ctx2, lineconfig);

        var ctx = document.getElementById('pie-chart').getContext('2d');
        window.myPie = new Chart(ctx, pieconfig);

        var ctx1 = document.getElementById('percentage-chart').getContext('2d');
        window.myBar = new Chart(ctx1, barconfig);
                      
           
        };
    
      </script>

{% endblock content %}